{
  "Version": "1.0",
  "Parameters": {
    "RuleName": "S3_BUCKET_SERVER_SIDE_ENCRYPTION_ENABLED",
    "SourceRuntime": null,
    "CodeKey": null,
    "InputParameters": "{}",
    "OptionalParameters": "{}",
    "SourceEvents": "AWS::S3::Bucket",
    "SourceIdentifier": "S3_BUCKET_SERVER_SIDE_ENCRYPTION_ENABLED",
    "RuleSets": [
      "baseline"
    ],
    "Remediation": {
      "Automatic": true,
      "ConfigRuleName": "S3_BUCKET_SERVER_SIDE_ENCRYPTION_ENABLED",
      "MaximumAutomaticAttempts": "2",
      "Parameters": {
        "AutomationAssumeRole": {
          "StaticValue": {
            "Values": [
              { "Fn::Sub": ["arn:aws:iam::${AWS::AccountId}:role/${S3BUCKETSERVERSIDEENCRYPTIONENABLEDIAM}", {"S3BUCKETSERVERSIDEENCRYPTIONENABLEDIAM": {"Fn::ImportValue": "S3-BUCKET-SERVER-SIDE-ENCRYPTION-ENABLED-sns-iam"}} ] }
            ]
          }
        },
        "Message": {
          "StaticValue": {
            "Values": [
              "hi"
            ]
          }
        },
        "TopicArn": {
          "StaticValue": {
            "Values": [
              { "Fn::Sub": ["arn:aws:sns:${AWS::Region}:${AWS::AccountId}:${S3BUCKETSERVERSIDEENCRYPTIONENABLEDSnsTopic}", {"S3BUCKETSERVERSIDEENCRYPTIONENABLEDSnsTopic": {"Fn::ImportValue": "S3-BUCKET-SERVER-SIDE-ENCRYPTION-ENABLED-sns-topic"}} ] }
            ]
          }
        }
      },
      "ResourceType": "AWS::EC2::Instance",
      "RetryAttemptSeconds": "2",
      "TargetId": "AWS-PublishSNSNotification",
      "TargetType": "SSM_DOCUMENT",
      "TargetVersion": "1"
    }
  },
  "Tags": "[{\"Key\" : \"keyname1\",\"Value\" : \"value1\"}]"
}
